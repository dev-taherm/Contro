{% extends "iam/base.html" %}

{% block title %}{% if mode == "create" %}New{% else %}Edit{% endif %} Entry · {{ content_type.name }} · Contro{% endblock %}

{% block content %}
  <div class="nav">
    <div>
      <div class="title">{% if mode == "create" %}New{% else %}Edit{% endif %} Entry</div>
      <div class="subtitle">Content type: {{ content_type.name }}</div>
    </div>
    <div>
      <a class="button" href="{% url 'content:entry_list' content_type.pk %}">Back to entries</a>
      {% if entry %}
        <form method="post" action="{% url 'content:entry_delete' content_type.pk entry.id %}" style="display:inline;">
          {% csrf_token %}
          <button class="button danger" type="submit">Delete</button>
        </form>
        {% if entry.status == "published" %}
          <form method="post" action="{% url 'content:entry_unpublish' content_type.pk entry.id %}" style="display:inline;">
            {% csrf_token %}
            <button class="button" type="submit">Unpublish</button>
          </form>
        {% else %}
          <form method="post" action="{% url 'content:entry_publish' content_type.pk entry.id %}" style="display:inline;">
            {% csrf_token %}
            <button class="button" type="submit">Publish</button>
          </form>
        {% endif %}
      {% endif %}
    </div>
  </div>

  <div class="card">
    <form method="post">
      {% csrf_token %}
      {{ form.non_field_errors }}
      {% for field in form %}
        <div class="form-row">
          <label for="{{ field.id_for_label }}">{{ field.label }}</label>
          {{ field }}
          {{ field.errors }}
        </div>
      {% endfor %}
      <button class="button" type="submit">Save</button>
    </form>
  </div>
{% endblock %}
