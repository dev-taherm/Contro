{% extends "iam/base.html" %}
{% load content_extras %}

{% block title %}Entries · {{ content_type.name }} · Contro{% endblock %}

{% block content %}
  <div class="nav">
    <div>
      <div class="title">Entries for {{ content_type.name }}</div>
      <div class="subtitle">Manage content entries.</div>
    </div>
    <a class="button" href="{% url 'content:entry_create' content_type.pk %}">New Entry</a>
  </div>

  <div class="card">
    {% if entries %}
      <table class="table table-premium align-middle" style="width:100%; border-collapse: collapse;">
        <thead>
          <tr style="text-align:left; border-bottom: 1px solid #1f2937;">
            <th style="padding: 8px;">ID</th>
            {% for field in fields %}
              <th style="padding: 8px;">{{ field.name }}</th>
            {% endfor %}
            <th style="padding: 8px;">Status</th>
            <th style="padding: 8px;">Published</th>
            <th style="padding: 8px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for entry in entries %}
            <tr style="border-bottom: 1px solid #1f2937;">
              <td style="padding: 8px;">{{ entry.id }}</td>
              {% for field in fields %}
                <td style="padding: 8px;">{{ entry|attr:field.slug }}</td>
              {% endfor %}
              <td style="padding: 8px;">{{ entry.get_status_display }}</td>
              <td style="padding: 8px;">{{ entry.published_at|default:"-" }}</td>
              <td style="padding: 8px;">
                <a href="{% url 'content:entry_edit' content_type.pk entry.id %}">Edit</a>
                <form method="post" action="{% url 'content:entry_delete' content_type.pk entry.id %}" class="d-inline">
                  {% csrf_token %}
                  <button class="btn btn-outline-danger btn-premium btn-sm" type="submit">Delete</button>
                </form>
                {% if entry.status == "published" %}
                  <form method="post" action="{% url 'content:entry_unpublish' content_type.pk entry.id %}" class="d-inline">
                    {% csrf_token %}
                    <button class="btn btn-outline-primary btn-premium btn-sm" type="submit">Unpublish</button>
                  </form>
                {% else %}
                  <form method="post" action="{% url 'content:entry_publish' content_type.pk entry.id %}" class="d-inline">
                    {% csrf_token %}
                    <button class="btn btn-primary btn-premium btn-sm" type="submit">Publish</button>
                  </form>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No entries yet.</p>
    {% endif %}
  </div>

  <div style="margin-top: 16px;">
    <a href="{% url 'content:type_edit' content_type.pk %}">Back to content type</a>
  </div>
{% endblock %}
